<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Vue面试相关 | 老杆的前端记录</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/logo.jpg">
    <meta name="description" content="Go big or go home">
    
    <link rel="preload" href="/assets/css/0.styles.e4d8b86b.css" as="style"><link rel="preload" href="/assets/js/app.585d659a.js" as="script"><link rel="preload" href="/assets/js/2.5bf1c715.js" as="script"><link rel="preload" href="/assets/js/15.d5d2b490.js" as="script"><link rel="prefetch" href="/assets/js/10.3c4722f1.js"><link rel="prefetch" href="/assets/js/11.926d9a65.js"><link rel="prefetch" href="/assets/js/12.89662875.js"><link rel="prefetch" href="/assets/js/13.b24d0fd4.js"><link rel="prefetch" href="/assets/js/14.fe4261ec.js"><link rel="prefetch" href="/assets/js/16.d7cb7df3.js"><link rel="prefetch" href="/assets/js/17.a8a539e4.js"><link rel="prefetch" href="/assets/js/18.9a7a379f.js"><link rel="prefetch" href="/assets/js/19.902e5d6c.js"><link rel="prefetch" href="/assets/js/20.89b4b03e.js"><link rel="prefetch" href="/assets/js/21.b9428d88.js"><link rel="prefetch" href="/assets/js/22.bca3e9c2.js"><link rel="prefetch" href="/assets/js/23.dd12f692.js"><link rel="prefetch" href="/assets/js/24.a1974514.js"><link rel="prefetch" href="/assets/js/25.e878ae6c.js"><link rel="prefetch" href="/assets/js/26.efd1416d.js"><link rel="prefetch" href="/assets/js/27.867f73b1.js"><link rel="prefetch" href="/assets/js/28.fbfc66d6.js"><link rel="prefetch" href="/assets/js/29.279cac21.js"><link rel="prefetch" href="/assets/js/3.2cde5f11.js"><link rel="prefetch" href="/assets/js/30.4a27f7bc.js"><link rel="prefetch" href="/assets/js/31.11173338.js"><link rel="prefetch" href="/assets/js/32.c2786358.js"><link rel="prefetch" href="/assets/js/33.8f760173.js"><link rel="prefetch" href="/assets/js/34.f437c018.js"><link rel="prefetch" href="/assets/js/35.ca6d5641.js"><link rel="prefetch" href="/assets/js/36.e670371f.js"><link rel="prefetch" href="/assets/js/37.c5143da6.js"><link rel="prefetch" href="/assets/js/38.83226dcf.js"><link rel="prefetch" href="/assets/js/39.29c51311.js"><link rel="prefetch" href="/assets/js/4.90c5fe7f.js"><link rel="prefetch" href="/assets/js/40.9f439bf9.js"><link rel="prefetch" href="/assets/js/41.817698ff.js"><link rel="prefetch" href="/assets/js/42.7086e250.js"><link rel="prefetch" href="/assets/js/5.93058ddb.js"><link rel="prefetch" href="/assets/js/6.0e5f5053.js"><link rel="prefetch" href="/assets/js/7.e30bb482.js"><link rel="prefetch" href="/assets/js/8.5e1ee355.js"><link rel="prefetch" href="/assets/js/9.574fd584.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e4d8b86b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">老杆的前端记录</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/guide/" class="nav-link">
  求职笔记
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端相关" class="dropdown-title"><span class="title">前端相关</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端相关" class="mobile-dropdown-title"><span class="title">前端相关</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontEnd/html/html-audition.html" class="nav-link">
  HTML
</a></li><li class="dropdown-item"><!----> <a href="/frontEnd/css/css-audition.html" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/frontEnd/js/js-audition.html" class="nav-link">
  JS
</a></li><li class="dropdown-item"><!----> <a href="/frontEnd/vue/vue-audition.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/frontEnd/webpack/webpack-audition.html" class="nav-link">
  Webpack
</a></li><li class="dropdown-item"><!----> <a href="/frontEnd/browser/browser-audition.html" class="nav-link">
  Browser
</a></li></ul></div></div><div class="nav-item"><a href="/computerBase/" class="nav-link">
  计算机基础
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/guide/" class="nav-link">
  求职笔记
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端相关" class="dropdown-title"><span class="title">前端相关</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端相关" class="mobile-dropdown-title"><span class="title">前端相关</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontEnd/html/html-audition.html" class="nav-link">
  HTML
</a></li><li class="dropdown-item"><!----> <a href="/frontEnd/css/css-audition.html" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/frontEnd/js/js-audition.html" class="nav-link">
  JS
</a></li><li class="dropdown-item"><!----> <a href="/frontEnd/vue/vue-audition.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/frontEnd/webpack/webpack-audition.html" class="nav-link">
  Webpack
</a></li><li class="dropdown-item"><!----> <a href="/frontEnd/browser/browser-audition.html" class="nav-link">
  Browser
</a></li></ul></div></div><div class="nav-item"><a href="/computerBase/" class="nav-link">
  计算机基础
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/frontEnd/vue/vue-audition.html" aria-current="page" class="active sidebar-link">Vue面试相关</a></li><li><a href="/frontEnd/vue/axios-principle.html" class="sidebar-link">Axios核心原理</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="vue面试相关"><a href="#vue面试相关" class="header-anchor">#</a> Vue面试相关</h1> <ul><li><p>vue的响应式原理，实现和问题？</p> <p>Vue双向绑定原理：用数据劫持和发布订阅模式实现</p> <p>data =&gt; view（数据劫持、发布订阅） view =&gt; data（事件监听），实现以下:</p> <p><strong>订阅器（Dep）：</strong></p> <p>数据被读或被写的时候，通知依赖数据的视图进行更新；主要收集订阅者，当数据变化的时候执行对应订阅者的回调函数；自身subs是Watcher类的数组，当全局唯一的Dep.target存在，则添加该Target</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">class</span> <span class="token class-name">Dep</span> <span class="token punctuation">{</span>
  <span class="token comment">// 根据 ts 类型提示，我们可以得出 Dep.target 是一个 Watcher 类型。</span>
  <span class="token keyword">static</span> target<span class="token operator">:</span> <span class="token operator">?</span>Watcher<span class="token punctuation">;</span>
  <span class="token comment">// subs 存放搜集到的 Watcher 对象集合</span>
  subs<span class="token operator">:</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span>Watcher<span class="token operator">&gt;</span><span class="token punctuation">;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>subs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">addSub</span><span class="token punctuation">(</span>sub<span class="token operator">:</span> Watcher<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 搜集所有使用到这个 data 的 Watcher 对象。</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>subs<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>sub<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">depend</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>Dep<span class="token punctuation">.</span>target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 搜集依赖，最终会调用上面的 addSub 方法</span>
      Dep<span class="token punctuation">.</span>target<span class="token punctuation">.</span><span class="token function">addDep</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> subs <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>subs<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> l <span class="token operator">=</span> subs<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> l<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 调用对应的 Watcher，更新视图</span>
      subs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
Dep<span class="token punctuation">.</span>target <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p><strong>订阅者（Watcher）：</strong></p> <p>new一个Watcher的时候，先会解析表达式，在data数据中取到值，执行this.get()，将<code>Dep.target</code>赋值为自身，强制读取模板中使用到的data中的值，读取的时候触发数据劫持中的<code>getter</code>函数，收集<code>Dep.target</code>这个Watcher实例对象。</p> <p>在订阅者Wacther初始化的时候触发对应的get函数，将自己收集起来，watcher传入对应的回调函数。在这中间Dep.target赋予自身，然后强制读属性值触发get劫持，这样就收集到依赖了。</p> <p><code>update</code>函数，当值发生变化的时候，调用watcher实例创建时传入的回调函数。</p></li></ul> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">Watcher</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> exp<span class="token punctuation">,</span> cb<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>vm <span class="token operator">=</span> vm<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>exp <span class="token operator">=</span> exp<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>cb <span class="token operator">=</span> cb<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 将自己添加到订阅器的操作</span>
<span class="token punctuation">}</span>

Watcher<span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">update</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">run</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> value <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>vm<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>exp<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> oldVal <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">!==</span> oldVal<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">cb</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>vm<span class="token punctuation">,</span> value<span class="token punctuation">,</span> oldVal<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Dep<span class="token punctuation">.</span>target <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span> <span class="token comment">// 全局变量 订阅者 赋值</span>
        <span class="token keyword">var</span> value <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>vm<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>exp<span class="token punctuation">]</span>  <span class="token comment">// 强制执行监听器里的get函数</span>
        Dep<span class="token punctuation">.</span>target <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token comment">// 全局变量 订阅者 释放</span>
        <span class="token keyword">return</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p><strong>监听器（Observer）:</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function-variable function">defineReactive</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span> key<span class="token punctuation">,</span> val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> dep <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Dep</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        enumerable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        configurable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token function">getter</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 读值的时候收集依赖</span>
            <span class="token comment">// 一个属性可以对应多个watcher</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>Dep<span class="token punctuation">.</span>target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                dep<span class="token punctuation">.</span><span class="token function">addSub</span><span class="token punctuation">(</span>Dep<span class="token punctuation">.</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> val<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token function">setter</span> <span class="token punctuation">(</span><span class="token parameter">newVal</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>newVal <span class="token operator">===</span> val<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// 值变的时候通知依赖更新</span>
            val <span class="token operator">=</span> newVal<span class="token punctuation">;</span>
            dep<span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>**解析器（Compiler）：**解析模板指令（<code>compileText</code>），替换模板数据，初始化watcher</p> <p><img src="/assets/img/01.278c953f.png" alt="图解"></p> <ul><li><p>Vue源码初始化过程：</p> <ul><li><code>_init</code>方法对props、method、data、computed进行初始化</li> <li><code>initData</code>主要干两件事：把vm._data.xxx代理到vm.xxx上、把data变为响应式对象</li> <li><code>observe</code>方法：返回ob对象，Observer实例对象，没有则要新new出来</li> <li><code>Observer</code>构造函数：是一个类，将对象的__ ob __属性赋值为自身，遍历对象的属性添加getter和setter，每一个Observer实例对象都有一个唯一的Dep类实例，每次<code>defineReactive</code>的时候也会新建一个dep类实例，用于依赖收集和派发更新。</li> <li><code>defineReactive</code>函数，get的时候触发<code>dep.depend()</code> ，也就执行了Dep.target.addDep(this)；set的时候触发<code>dep.notify</code>触发更新</li> <li><code>Dep</code>是一个类，自身的subs数组是Watcher的数组</li></ul></li> <li><p>$set原理：用于向响应式对象中添加一个property，确保新property也是响应式的，且触发视图更新</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">set</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 数组</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isValidArrayIndex</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 修改数组长度，避免索引大于数组长度导致splice错误</span>
    target<span class="token punctuation">.</span>length <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span>length<span class="token punctuation">,</span> key<span class="token punctuation">)</span>
    <span class="token comment">// 利用数组splice触发响应</span>
    target<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> val<span class="token punctuation">)</span>
    <span class="token keyword">return</span> val
  <span class="token punctuation">}</span>
  <span class="token comment">// key 已经存在，直接修改属性值</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>key <span class="token keyword">in</span> target <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token punctuation">(</span>key <span class="token keyword">in</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    target<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> val
    <span class="token keyword">return</span> val
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> ob <span class="token operator">=</span> target<span class="token punctuation">.</span>__ob__
  <span class="token comment">// target 不是响应式的，直接赋值</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>ob<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    target<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> val
    <span class="token keyword">return</span> val
  <span class="token punctuation">}</span>
  <span class="token comment">// 响应式处理属性</span>
  <span class="token function">defineReactive</span><span class="token punctuation">(</span>ob<span class="token punctuation">.</span>value<span class="token punctuation">,</span> key<span class="token punctuation">,</span> val<span class="token punctuation">)</span>
  <span class="token comment">// 派发更新</span>
  ob<span class="token punctuation">.</span>dep<span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> val
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div></li> <li><p>v-model原理</p> <p>text 和 textarea 元素使用 value 属性和 input 事件；</p> <p>checkbox 和 radio 使用 checked 属性和 change 事件；</p> <p>select 字段将 value 作为 prop 并将 change 作为事件;</p> <p>利用Object.defineProperty()劫持绑定的数据，绑定input事件将表单的值赋予绑定的值</p></li> <li><p>computed原理</p> <p><code>initComputed</code>函数：</p> <ul><li>循环computed选项，判断是直接函数定义的还是有区分get函数和set函数定义的</li> <li>computed自身有一个<code>watchers</code>，用于管理计算属性每个值的watcher</li> <li>watchers[key]赋值为一个Watcher类实例，对于计算属性会为Watcher类实例添加一个依赖收集器dep实例</li> <li><code>defineComputed</code>让computed变为一个响应式数据</li> <li>初始化的时候get一下这个计算属性，计算属性用到的属性就会收集到依赖，当用到这个计算属性的时候触发它的defineProperty的get函数，也会收集到依赖，向自身dep的subs中添加其他属性的watcher</li></ul></li> <li><p>vuex原理</p> <p>vuex本质上是一个对象，有两个属性，一个install方法，一个Store类。</p> <p>install方法将store类实例挂载在所有组件身上</p> <p>Store这个类拥有dispatch、commit方法</p> <p>将用户传入的state，转化成new Vue实例的data属性传入，以达到state里面的数据是响应式</p> <p>调用了Vue.mixin方法，在所有组件的beforeCreate声明周期中设置了this.$store对象</p> <p>Vuex的双向数据绑定实则是调用new Vue实现的，通过Vue.mixin注入到Vue组件的生命周期中，每一个vm实例都会调用vuexInit方法</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Store</span><span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            data<span class="token operator">:</span><span class="token punctuation">{</span>
                state <span class="token operator">:</span>options<span class="token punctuation">.</span>state
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">let</span> getters <span class="token operator">=</span> options<span class="token punctuation">.</span>getter <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>getters <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>getters<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">getterName</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>getters<span class="token punctuation">,</span> getterName<span class="token punctuation">,</span> <span class="token punctuation">{</span>
                <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                    <span class="token keyword">return</span> getters<span class="token punctuation">[</span>getterName<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        
    <span class="token punctuation">}</span>
    <span class="token keyword">get</span> <span class="token function">state</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>vm<span class="token punctuation">.</span>state<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> <span class="token function-variable function">install</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">Vue</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    Vue<span class="token punctuation">.</span><span class="token function">mixin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token function">beforeCreate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> vuex <span class="token operator">=</span> <span class="token punctuation">{</span>
    Store<span class="token punctuation">,</span>
    install
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> vuex
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div></li> <li><p>Vue-router的导航守卫解析流程</p> <p>导航被触发。</p> <p>在失活的组件里调用 <code>beforeRouteLeave</code> 守卫。</p> <p>调用全局的 <code>beforeEach</code> 守卫。</p> <p>在重用的组件里调用 <code>beforeRouteUpdate</code> 守卫 (2.2+)。</p> <p>在路由配置里调用 <code>beforeEnter</code>。</p> <p>解析异步路由组件。</p> <p>在被激活的组件里调用 <code>beforeRouteEnter</code>。</p> <p>调用全局的 <code>beforeResolve</code> 守卫 (2.5+)。</p> <p>导航被确认。</p> <p>调用全局的 <code>afterEach</code> 钩子。</p> <p>触发 DOM 更新。</p> <p>调用 <code>beforeRouteEnter</code> 守卫中传给 <code>next</code> 的回调函数，创建好的组件实例会作为回调函数的参数传入。</p></li> <li><p>Vue的异步更新机制</p> <p>内部实现了nexttick方法，当触发某个数据的setter的时候，setter函数会通知Dep，Dep会调用它所管理的所有Watcher类实例，触发update方法</p> <p>queneWatcher函数，将watcher放入watcher队列，不会将watcher重复写入，将watcher放入队列的合适位置，传入nexttick函数。</p></li> <li><p>vue组件data为什么必须是函数？</p></li> <li><p>Object.defineProperty数据劫持的缺点：</p> <p>用数组下标方式修改数组数据、监听数组长度、监听在对象初始化时不存在的属性，不会触发响应式</p></li> <li><p>VueRouter是怎么实现的？（哈希实现、history实现）</p> <p>将插件添加到installedPlugins中，保证相同的插件不会反复被注册</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">HistoryRoute</span><span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>current <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">VueRouter</span><span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>mode <span class="token operator">=</span> options<span class="token punctuation">.</span>mode <span class="token operator">||</span> <span class="token string">'hash'</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>routes <span class="token operator">=</span> options<span class="token punctuation">.</span>routes <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>routesMap <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">createMap</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>routes<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 创建路径和组件之间的映射关系</span>
        <span class="token comment">// 根据mode选择实例化的路由类型</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>history <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HistoryRoute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 保存当前的路径</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 初始化路由</span>
    <span class="token punctuation">}</span>
    <span class="token function">createMap</span><span class="token punctuation">(</span><span class="token parameter">routes</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> routes<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">pre<span class="token punctuation">,</span> cur</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            pre<span class="token punctuation">[</span>cur<span class="token punctuation">.</span>path<span class="token punctuation">]</span> <span class="token operator">=</span> cur<span class="token punctuation">.</span>component<span class="token punctuation">;</span>
            <span class="token keyword">return</span> pre<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>mode <span class="token operator">===</span> <span class="token string">'hash'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
           location<span class="token punctuation">.</span>hash <span class="token operator">?</span> <span class="token string">&quot;&quot;</span> <span class="token operator">:</span> location<span class="token punctuation">.</span>hash <span class="token operator">=</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">;</span>
            window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'load'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>history<span class="token punctuation">.</span>cur <span class="token operator">=</span> location<span class="token punctuation">.</span>hash<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
            window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'hashchange'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>history<span class="token punctuation">.</span>cur <span class="token operator">=</span> location<span class="token punctuation">.</span>hash<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
            
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        
    <span class="token punctuation">}</span>
    <span class="token function">replace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 调用vue.use调用install方法</span>
VueRouter<span class="token punctuation">.</span><span class="token function-variable function">install</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">v</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    Vue <span class="token operator">=</span> v<span class="token punctuation">;</span>
    Vue<span class="token punctuation">.</span><span class="token function">mixin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token comment">// 全局混入 保证每个组件都有$router这个属性 _root是this 子组件通过访问父组件router</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment">// 注册router-view 就是拿到router实例中的cur和映射表，渲染对应的组件出来</span>
    <span class="token comment">// 注册router-link 默认就是渲染出来一个a标签，拿到to属性 href跳转</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br></div></div><p>哈希实现：利用location.hash就能改变 a标签的href能直接实现，href = &quot;#/xxx&quot;,如果没带#会向服务器请求该资源出现错误，<code>window.location.hash</code> = &quot;&quot;能实现改变url中的hash值</p> <p>历史实现：利用history API push、replace实现url的跳转，添加或替代历史记录，再调用相应的注册回调函数；而点击浏览器前进后退会触发<code>popstate</code>事件；历史模式需要阻止a标签的默认行为，当点击为a标签时手动将其跳转的url添加进历史记录并实现url跳转</p> <p>两者都需提供注册路由的方法，路径+回调的形式注册</p></li> <li><p>路由模式hash和history的区别</p> <p>hash值会出现在URL里#/xxx xxx的变化不会向服务器发送请求，改变hash值不会刷新页面，对后端没有影响</p> <p>history模式需要后台配置，会向后端发送请求</p></li> <li><p>hash跳转和输入url跳转有什么不同</p> <p>刷新页面和不刷新页面的区别</p></li> <li><p>$nextTick原理。在Vue实例更改数据之后，立刻执行回调，获得更新之后的dom。</p> <p>callbacks数组收集回调函数的队列。新增回调函数后又执行<code>timefunc</code>函数。</p> <p><code>timefunc</code>函数：将<code>timefunc</code>赋予一个函数，根据兼容性赋予不同的函数实现。第一顺位是Promise.then、MutationObserver、setImmediate、最后一个顺位是setTimeout。降级处理的目的都是将一个<code>flushCallbacks</code>函数放入微任务或者宏任务中。</p> <p><code>flushCallbacks</code>函数就是将收集到的回调复制一份，再分别执行里面的回调。</p> <p>将回调函数放到微任务或宏任务中，看兼容性，一般优先放进微任务，所以nextTick一般情况下总是先于setTimeout执行）Vue在更新DOM的时候是异步的（用于在数据变化之后，dom更新之后触发传入的回调函数</p> <p>微任务：Promise.then、mutationObserver</p> <p>宏任务：setTimeOut 、MessageChannel、postMessage、setImmediate</p> <p>每次事件循环总会执行完同步代码后，再执行微任务，再执行宏任务，执行一个宏任务后都要清空所有的微任务</p> <p>$nexttick为什么在回调函数可以获得那个dom节点？</p></li> <li><p>SPA的理解：</p> <p>初始化的时候加载Web页面所需的HTML、JavaScript、Css等资源，加载完成之后不会因用户的操作而进行页面的重新加载或跳转，取而代之的是实现HTML内容的替换，UI与用户交互，避免页面的重复加载。缺点是首屏打开速度慢，不利于SEO。</p></li> <li><p>SEO的理解</p> <p>搜索引擎优化，利用搜索引擎的规则提高网站在有关搜索引擎内的自然排名。SPA单页面应用，通过ajax获取数据，很难保证我们的页面能被搜索引擎发现。为了解决这个问题，就需要用到SSR。</p></li> <li><p>SSR的理解</p> <p>将Vue客户端代码渲染成HTML文件的工作放在服务端进行，然后再把HTML返回给客户端</p> <p>SSR大致的意思就是vue在客户端将标签渲染成的整个 html 片段的工作在服务端完成，服务端形成的html 片段直接返回给客户端这个过程就叫做服务端渲染。</p> <p>优点：更好的SEO，首屏加载更快</p></li> <li><p>Vue优化</p> <ul><li>编码阶段的优化：key值保证唯一；防抖节流；图片懒加载；keep-alive；尽量减少data中的数据</li> <li>打包的时候的优化：CDN；Tree-shaking；压缩代码；splitChunk；多线程打包</li> <li>用户体验的优化：骨架屏；PWA；客户端缓存</li> <li>SEO的优化：SSR</li></ul></li> <li><p>$set()原理（如果target不是响应式对象，则不用为这个属性搞成响应式），注意点，vue实例和实例根数据对象不能使用set</p></li> <li><p>watch和computed的区别</p> <p>computed是计算一个新的属性挂载到vm上，而watch是监听已经存在并挂载到vm上的数据，所以watch也可以监听computed</p> <p>使用 <code>watch</code> 选项允许我们执行异步操作 (访问一个 API)，限制我们执行该操作的频率，并在我们得到最终结果前，设置中间状态。这些都是计算属性无法做到的</p> <p>计算属性是基于响应依赖关系走缓存的，watch则当数据变化就会调用执行函数</p></li> <li><p>diff算法，diff的过程就是调用patch的函数</p> <p>虚拟dom之间的比较，只比较同一层的节点，不做跨层级的比较，先将DOM转化为虚拟dom，比较Vnode和OldVnode</p> <p>先调用isSameNode（相同key、相同标签、是否同为注释、虚拟dom的data是否一样如@click等，input标签需要相同type）方法</p> <ul><li>如果oldVNode和Vnode不相同，即不值得做深层次比较，直接用新节点替换老结点</li> <li>如果相同，则比较子节点（调用patchVnode方法，传入两个结点的children）：
<ul><li>都有文本节点并且不相等，则新节点的文本替换旧结点的</li> <li>oldVnode和Vnode是否指向的是同一个对象，是则直接返回</li> <li>oldVNode有子节点而VNode没有子节点，则删除旧DOM的子节点</li> <li>oldVNode没有子节点而VNode有子节点，则新增新DOM的子节点</li> <li>都有子节点，执行updateChildren（oldCh，newCh）方法，用特殊的算法比较新旧子节点是否相同
<ul><li>新前和旧前相等，位置不变，移动指针</li> <li>新后和旧后相等，位置不变，移动指针</li> <li>新后和旧前相等，旧前指向的结点现在跑到最后了，所以要移动到最后，利用旧前</li> <li>新前和旧后相等，旧后指向的结点现在跑到最前了，所以要移动到最前，利用旧后</li> <li>如果上面四种特殊位置都不相同，则需要遍历oldCh挨个和新前指向的比较，匹配成功就将新前指向的结点放在最前，因为新前，是指现在所剩dom中最前面的结点；如果仍没有成功，那么将新前指向的节点插入到旧前之前，start移动</li> <li>匹配结束后，老的有剩，则将区间[oldStart, oldEnd]的结点删除</li> <li>匹配结束后，新的有剩，则将多余的Vch根据当前所在位置（index）更新，添加到dom中，新的现在是哪个index就插在哪</li></ul></li></ul></li></ul></li> <li><p>对前端路由的理解</p> <p>AJAX的出现，让用户不用重新刷新页面就能获取数据，SPA页面是通过JS动态的变换HTML的内容，页面的url并没有改变，导致SPA页面无法记录用户在页面的操作，如前进后退等，SPA由于业务的不同有多种页面展示，但只有一个url，对SEO不好</p> <p>在保证只有一个HTML文件的情况下，且用户交互是不刷新页面和步跳转页面的情况下，为每个视图匹配一个特殊的url，这就需要实现改变url不让浏览器向服务器发送请求，可以监听url变化</p></li> <li><p>vue中子组件调用父组件的方法</p></li> <li><p>子组件和父组件生命周期函数的调用顺序，现有父后有子，子先创建完成，父再创建完成</p></li> <li><p>MVVM的理解（双向绑定），和MVC的区别</p> <p>model、viewmodel、view，数据变化更新视图，视图变化更新数据</p> <p>view =&gt; data主要通过事件监听的方式进行</p></li> <li><p>自定义组件的v-model</p></li> <li><p>v-show和v-if的区别；v-if会触发生命周期函数</p></li> <li><p>vuex</p> <ul><li>mapstate、mapGetters等</li> <li>mutation为什么不能做异步操作：mutation是vuex状态更新的唯一途径，如果也能异步，devtools就不能对状态进行快照追踪，跟踪每一个状态的变化。</li></ul></li> <li><p>v-clock：和Css规则[v-clock]{display: none;}一起使用，这个指令可以隐藏所指定的元素直到组件实例准备完毕，直到组件结束编译</p></li> <li><p>Vue3 和 Vue2的区别：</p> <ul><li><p><strong>双向数据绑定的原理不同</strong>，Proxy代理整个对象，defineProperty</p></li> <li><p><strong>生命钩子函数的变化</strong></p></li> <li><p>Vue3 template能for循环且能加key</p></li> <li><p><strong>Vue3能有多个根节点，即支持碎片</strong></p></li> <li><p>Vue3 可以对事件进行继承 @change能继承到子组件的根标签上</p></li> <li><p>Vue3 app.component('xxx', emits: []) 新增emits选项指定自定义事件的名称 emits选项可以配置对事件的验证</p></li> <li><p>Vue3： v-model = &quot;isVisible&quot; 相当于  :modelValue @update:modelValue = &quot;&quot; ，</p> <p>而v-model:title = &quot;xxx&quot; 相当于在组件有:title = “” 的传递子组件的prop  @update:title = “”的自定义事件</p></li> <li><p>Vue3可以自定义v-model的修饰符</p> <p>Vue2可用modal选项自定义组件的v-modal</p></li> <li><p>Vue3：组合式API避免了组件碎片化和维护复杂 选项的分离有潜在的逻辑问题，将同一逻辑关注点相关代码收集在一起</p> <ul><li>setup的调用在data、computed、methods被解析之前，在beforeCreate之前</li> <li>在初始props解析之后调用</li> <li>setup(props, context),props不能解构,响应式对象的解构</li></ul></li> <li><p>Vue3响应式API</p> <ul><li>ref能代理对象，reactive不能代理JS基本数据类型</li> <li>不能解构reactive代理的响应式对象，要用toRefs将响应式对象中的值都转为ref类型的值</li> <li>响应式监听watchEffect：无需手动传值，无法得到老值，会自动收集依赖先执行一次回调函数</li></ul></li> <li><p>Vue3自定义指令的钩子函数和Vue2不同了</p></li> <li><p><strong>&lt; teleport &gt;组件</strong>: 允许我们控制在DOM中哪个父节点下渲染HTML，希望在某个深层次里使用组件，但又不希望渲染出来的DOM在那么深。</p></li> <li><p><strong>&lt; suspense &gt;组件</strong>：提供default、fallback插槽</p></li> <li><p>渲染函数返回一个VNode：Vue3可以创建组件VNode，选项对象的属性也不一致了</p></li> <li><p>Vue3列表过度 tansition-group组件默认情况下不会渲染一个包裹元素，Vue2是span元素</p></li> <li><p>Vue3在列表的移动过渡是新增了v-move类</p></li> <li><p>Vue3新增 globalProperties全局配置 通过app.config.globalProperties添加一个可以在应用的任何组件实例上访问的属性，替代Vue2.x的Vue.prototype扩展</p></li> <li><p>Vue3新增expose选项：一个暴露在公共组件实例上的property列表</p></li> <li><p>Vue3声明周期钩子相比于Vue2.x有所改变</p></li> <li><p><strong>Vue3移除了Vue2.x的过滤器选项</strong>，也不再支持过滤器写法。</p></li> <li><p>Vue3定义动态组件：defineAsyncComponent({ })；Vue2.x定义动态组件：const xxx = () =&gt; ({ component : import('./')})</p></li> <li><p>Vue3组件属性$slot获取插槽内容的写法不一样 Vue3是一个方法 $slots.default() Vue2是一个属性$slots.default</p></li> <li><p>Vue3 组件实例方法$watch选项除了deep、immediate新增flush：更好的控制回调函数执行的时间</p></li> <li><p>Vue3增加v-memo指令：接收一个固定长度的数组，如果数组中的每个值都和上一次渲染相同，则整个子树的更新将会被跳过</p></li> <li><p>Vue3 .vue单文件组件中可以最多包含一个<script setup=""></script></p></li></ul></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/frontEnd/vue/axios-principle.html">
        Axios核心原理
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.585d659a.js" defer></script><script src="/assets/js/2.5bf1c715.js" defer></script><script src="/assets/js/15.d5d2b490.js" defer></script>
  </body>
</html>
